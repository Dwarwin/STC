function ajaxReq(e,s,t,o){var a=new XMLHttpRequest;a.open("POST",s),a.setRequestHeader("Content-Type","application/json"),a.send(JSON.stringify(e)),a.onerror=function(){modalPopup(t,"Server connect error: "+a.status)},a.onload=function(){var e=JSON.parse(a.responseText);401==this.status?(modalPopup(t,"Session time ended"),setTimeout(logOut,2e3)):404==this.status&&"User not found"==e.errorMessage?modalPopup(t,"Authorization error: wrong username or password"):500==this.status&&"User already exist"==e.errorMessage?modalPopup(t,"User already exist"):500==this.status?modalPopup(t,"Server error: "+this.status):200==this.status&&!e.isLocked&&e.createdDate?(modalPopup(t,"Registration successful"),setTimeout(function(){$("#servMsg").modal("hide"),$("#reg-modal").modal("hide"),$("#login-modal").modal("show")},2e3)):200==this.status&&e.access_token&&(o.checked?localStorage.accessToken=e.access_token:sessionStorage.accessToken=e.access_token,modalPopup(t,"Authorization successful"),setTimeout(redir,2e3,"index.html"))}}function modalPopup(e,s){e.innerHTML=s,$("#servMsg").modal("show")}function redir(e){window.location.href=e}function logOut(){localStorage.accessToken&&delete localStorage.accessToken,sessionStorage.accessToken&&delete sessionStorage.accessToken,redir("index.html")}function regSubmit(){var e=function(e){var s=/(?=^.{3,20}$)^[a-zA-Z][a-zA-Z0-9]*[\s._-]?[a-zA-Z0-9]+$/;return s.test(e)},s=function(e){var s=/(?=^.{2,20}$)^[A-Z]*[a-zA-Z0-9]*[\s-]?[A-Z][a-zA-Z0-9]+$/;return s.test(e)},t=function(e){var s=/(?=^.{2,20}$)^[A-Z]*[a-zA-Z0-9]*[\s-]?[A-Z][a-zA-Z0-9]+$/;return s.test(e)},o=function(e){var s=/[a-z0-9._%+-]+@[a-z0-9.-]+\.[a-z]{2,3}$/;return s.test(e)},a=function(e){var s=/(0[1-9]|[12][0-9]|3[01])[- \/.](0[1-9]|1[012])[- \/.](19|20)\d\d/;return s.test(e)},r=function(e){var s=/(?=.*\d)(?=.*[a-z])(?=.*[A-Z]).{6,}/;return s.test(e)},l=document.getElementById("reg-form"),n=document.getElementById("modalTxt"),d=!0,i=document.getElementById("username"),c=document.getElementById("firstName"),u=document.getElementById("lastName"),m=document.getElementById("email"),p=(document.getElementsByName("sex"),document.getElementById("bday")),g=document.getElementById("pswd"),h=document.getElementById("repswd"),v=document.getElementById("terms"),L=document.getElementById("alertErr"),f=document.getElementById("alertSuc");if(e(i.value))y=i.parentNode,y.classList.remove("has-error"),y.classList.add("has-success"),$(i).tooltip("destroy");else{var y=i.parentNode;y.classList.remove("has-success"),y.classList.add("has-error"),$(i).tooltip({trigger:"toggle",placement:"top"}).tooltip("hide"),d=!1}if(s(c.value))y=c.parentNode,y.classList.remove("has-error"),y.classList.add("has-success"),$(c).tooltip("destroy");else{var y=c.parentNode;y.classList.remove("has-success"),y.classList.add("has-error"),$(c).tooltip({trigger:"toggle",placement:"top"}).tooltip("hide"),d=!1}if(t(u.value))y=u.parentNode,y.classList.remove("has-error"),y.classList.add("has-success"),$(u).tooltip("destroy");else{var y=u.parentNode;y.classList.remove("has-success"),y.classList.add("has-error"),$(u).tooltip({trigger:"toggle",placement:"top"}).tooltip("hide"),d=!1}if(o(m.value))y=m.parentNode,y.classList.remove("has-error"),y.classList.add("has-success"),$(m).tooltip("destroy");else{var y=m.parentNode;y.classList.remove("has-success"),y.classList.add("has-error"),$(m).tooltip({trigger:"toggle",placement:"top"}).tooltip("hide"),d=!1}if(a(p.value))y=p.parentNode,y.classList.remove("has-error"),y.classList.add("has-success"),$(p).tooltip("destroy");else{var y=p.parentNode;y.classList.remove("has-success"),y.classList.add("has-error"),$(p).tooltip({trigger:"toggle",placement:"top"}).tooltip("hide"),d=!1}if(r(g.value))y=g.parentNode,y.classList.remove("has-error"),y.classList.add("has-success"),$(g).tooltip("destroy");else{var y=g.parentNode;y.classList.remove("has-success"),y.classList.add("has-error"),$(g).tooltip({trigger:"toggle",placement:"top"}).tooltip("hide"),d=!1}if(h.value!=g.value||""==g.value){var y=h.parentNode;y.classList.remove("has-success"),y.classList.add("has-error"),$(h).tooltip({trigger:"toggle",placement:"top"}).tooltip("hide"),d=!1}else y=h.parentNode,y.classList.remove("has-error"),y.classList.add("has-success"),$(h).tooltip("destroy");if(null==f&&null==L||(d?(L.classList.add("hidden"),f.classList.remove("hidden")):(f.classList.add("hidden"),L.classList.remove("hidden"))),null!=v)if(v.checked)$(v).tooltip("hide");else{var y=h.parentNode;$(v).tooltip({trigger:"toggle",placement:"top",title:"Accept terms and conditions"}).tooltip("show"),d=!1}if(d){var B={login:i.value,email:m.value,password:g.value};ajaxReq(B,l.action,n)}return d=!1}function logSubmit(){var e=document.getElementById("login-form"),s=document.getElementById("modalTxt"),t=document.getElementById("remember_me"),o=function(e){var s=/(?=^.{3,20}$)^[a-zA-Z][a-zA-Z0-9]*[\s._-]?[a-zA-Z0-9]+$/;return s.test(e)},a=function(e){var s=/(?=.*\d)(?=.*[a-z])(?=.*[A-Z]).{6,}/;return s.test(e)},r=!0,l=document.getElementById("inputUsername"),n=document.getElementById("inputPassword");if(o(l.value))d=l.parentNode,d.classList.remove("has-error"),d.classList.add("has-success"),$(l).tooltip("destroy");else{var d=l.parentNode;d.classList.remove("has-success"),d.classList.add("has-error"),$(l).tooltip({trigger:"toggle",placement:"top"}).tooltip("hide"),r=!1}if(a(n.value))d=n.parentNode,d.classList.remove("has-error"),d.classList.add("has-success"),$(n).tooltip("destroy");else{var d=n.parentNode;d.classList.remove("has-success"),d.classList.add("has-error"),$(n).tooltip({trigger:"toggle",placement:"top"}).tooltip("hide"),r=!1}if(r){var i={login:l.value,password:n.value};ajaxReq(i,e.action,s,t)}return r=!1}function ajaxReq(e,s,t,o){var a=new XMLHttpRequest;a.open("POST",s),a.setRequestHeader("Content-Type","application/json"),a.send(JSON.stringify(e)),a.onerror=function(){modalPopup(t,"Server connect error: "+a.status)},a.onload=function(){var e=JSON.parse(a.responseText);401==this.status?(modalPopup(t,"Session time ended"),setTimeout(logOut,2e3)):404==this.status&&"User not found"==e.errorMessage?modalPopup(t,"Authorization error: wrong username or password"):500==this.status&&"User already exist"==e.errorMessage?modalPopup(t,"User already exist"):500==this.status?modalPopup(t,"Server error: "+this.status):200==this.status&&!e.isLocked&&e.createdDate?(modalPopup(t,"Registration successful"),setTimeout(function(){$("#servMsg").modal("hide"),$("#reg-modal").modal("hide"),$("#login-modal").modal("show")},2e3)):200==this.status&&e.access_token&&(o.checked?localStorage.accessToken=e.access_token:sessionStorage.accessToken=e.access_token,modalPopup(t,"Authorization successful"),setTimeout(redir,2e3,"index.html"))}}function modalPopup(e,s){e.innerHTML=s,$("#servMsg").modal("show")}function redir(e){window.location.href=e}function logOut(){localStorage.accessToken&&delete localStorage.accessToken,sessionStorage.accessToken&&delete sessionStorage.accessToken,redir("index.html")}function regSubmit(){var e=function(e){var s=/(?=^.{3,20}$)^[a-zA-Z][a-zA-Z0-9]*[\s._-]?[a-zA-Z0-9]+$/;return s.test(e)},s=function(e){var s=/(?=^.{2,20}$)^[A-Z]*[a-zA-Z0-9]*[\s-]?[A-Z][a-zA-Z0-9]+$/;return s.test(e)},t=function(e){var s=/(?=^.{2,20}$)^[A-Z]*[a-zA-Z0-9]*[\s-]?[A-Z][a-zA-Z0-9]+$/;return s.test(e)},o=function(e){var s=/[a-z0-9._%+-]+@[a-z0-9.-]+\.[a-z]{2,3}$/;return s.test(e)},a=function(e){var s=/(0[1-9]|[12][0-9]|3[01])[- \/.](0[1-9]|1[012])[- \/.](19|20)\d\d/;return s.test(e)},r=function(e){var s=/(?=.*\d)(?=.*[a-z])(?=.*[A-Z]).{6,}/;return s.test(e)},l=document.getElementById("reg-form"),n=document.getElementById("modalTxt"),d=!0,i=document.getElementById("username"),c=document.getElementById("firstName"),u=document.getElementById("lastName"),m=document.getElementById("email"),p=(document.getElementsByName("sex"),document.getElementById("bday")),g=document.getElementById("pswd"),h=document.getElementById("repswd"),v=document.getElementById("terms"),L=document.getElementById("alertErr"),f=document.getElementById("alertSuc");if(e(i.value))y=i.parentNode,y.classList.remove("has-error"),y.classList.add("has-success"),$(i).tooltip("destroy");else{var y=i.parentNode;y.classList.remove("has-success"),y.classList.add("has-error"),$(i).tooltip({trigger:"toggle",placement:"top"}).tooltip("hide"),d=!1}if(s(c.value))y=c.parentNode,y.classList.remove("has-error"),y.classList.add("has-success"),$(c).tooltip("destroy");else{var y=c.parentNode;y.classList.remove("has-success"),y.classList.add("has-error"),$(c).tooltip({trigger:"toggle",placement:"top"}).tooltip("hide"),d=!1}if(t(u.value))y=u.parentNode,y.classList.remove("has-error"),y.classList.add("has-success"),$(u).tooltip("destroy");else{var y=u.parentNode;y.classList.remove("has-success"),y.classList.add("has-error"),$(u).tooltip({trigger:"toggle",placement:"top"}).tooltip("hide"),d=!1}if(o(m.value))y=m.parentNode,y.classList.remove("has-error"),y.classList.add("has-success"),$(m).tooltip("destroy");else{var y=m.parentNode;y.classList.remove("has-success"),y.classList.add("has-error"),$(m).tooltip({trigger:"toggle",placement:"top"}).tooltip("hide"),d=!1}if(a(p.value))y=p.parentNode,y.classList.remove("has-error"),y.classList.add("has-success"),$(p).tooltip("destroy");else{var y=p.parentNode;y.classList.remove("has-success"),y.classList.add("has-error"),$(p).tooltip({trigger:"toggle",placement:"top"}).tooltip("hide"),d=!1}if(r(g.value))y=g.parentNode,y.classList.remove("has-error"),y.classList.add("has-success"),$(g).tooltip("destroy");else{var y=g.parentNode;y.classList.remove("has-success"),y.classList.add("has-error"),$(g).tooltip({trigger:"toggle",placement:"top"}).tooltip("hide"),d=!1}if(h.value!=g.value||""==g.value){var y=h.parentNode;y.classList.remove("has-success"),y.classList.add("has-error"),$(h).tooltip({trigger:"toggle",placement:"top"}).tooltip("hide"),d=!1}else y=h.parentNode,y.classList.remove("has-error"),y.classList.add("has-success"),$(h).tooltip("destroy");if(null==f&&null==L||(d?(L.classList.add("hidden"),f.classList.remove("hidden")):(f.classList.add("hidden"),L.classList.remove("hidden"))),null!=v)if(v.checked)$(v).tooltip("hide");else{var y=h.parentNode;$(v).tooltip({trigger:"toggle",placement:"top",title:"Accept terms and conditions"}).tooltip("show"),d=!1}if(d){var B={login:i.value,email:m.value,password:g.value};ajaxReq(B,l.action,n)}return d=!1}function logSubmit(){var e=document.getElementById("login-form"),s=document.getElementById("modalTxt"),t=document.getElementById("remember_me"),o=function(e){var s=/(?=^.{3,20}$)^[a-zA-Z][a-zA-Z0-9]*[\s._-]?[a-zA-Z0-9]+$/;return s.test(e)},a=function(e){var s=/(?=.*\d)(?=.*[a-z])(?=.*[A-Z]).{6,}/;return s.test(e)},r=!0,l=document.getElementById("inputUsername"),n=document.getElementById("inputPassword");if(o(l.value))d=l.parentNode,d.classList.remove("has-error"),d.classList.add("has-success"),$(l).tooltip("destroy");else{var d=l.parentNode;d.classList.remove("has-success"),d.classList.add("has-error"),$(l).tooltip({trigger:"toggle",placement:"top"}).tooltip("hide"),r=!1}if(a(n.value))d=n.parentNode,d.classList.remove("has-error"),d.classList.add("has-success"),$(n).tooltip("destroy");else{var d=n.parentNode;d.classList.remove("has-success"),d.classList.add("has-error"),$(n).tooltip({trigger:"toggle",placement:"top"}).tooltip("hide"),r=!1}if(r){var i={login:l.value,password:n.value};ajaxReq(i,e.action,s,t)}return r=!1}$(document).ready(function(){var e=function(e){if(e.files&&e.files[0]){var s=new FileReader;s.onload=function(e){$(".img-thumbnail").attr("src",e.target.result)},s.readAsDataURL(e.files[0])}};$(".file-upload").on("change",function(){e(this)});var s=document.getElementById("regBtn"),t=document.getElementById("logBtn"),o=document.getElementById("userPanel");null!=s&&null!=t&&null!=o&&(localStorage.accessToken||sessionStorage.accessToken&&null!=s&&null!=t&&null!=o?(s.classList.add("hidden"),t.classList.add("hidden"),o.classList.remove("hidden")):(s.classList.remove("hidden"),t.classList.remove("hidden"),o.classList.add("hidden")))}),$("button[type='reset']").on("click",function(){for(var e=document.getElementById("alertErr"),s=document.getElementById("alertSuc"),t=document.getElementsByClassName("has-error"),o=document.getElementsByClassName("has-success");t.length>0;)t[0].classList.remove("has-error");for(;o.length>0;)o[0].classList.remove("has-success");e.classList.add("hidden"),s.classList.add("hidden")}),$(document).ready(function(){var e=function(e){if(e.files&&e.files[0]){var s=new FileReader;s.onload=function(e){$(".img-thumbnail").attr("src",e.target.result)},s.readAsDataURL(e.files[0])}};$(".file-upload").on("change",function(){e(this)});var s=document.getElementById("regBtn"),t=document.getElementById("logBtn"),o=document.getElementById("userPanel");null!=s&&null!=t&&null!=o&&(localStorage.accessToken||sessionStorage.accessToken&&null!=s&&null!=t&&null!=o?(s.classList.add("hidden"),t.classList.add("hidden"),o.classList.remove("hidden")):(s.classList.remove("hidden"),t.classList.remove("hidden"),o.classList.add("hidden")))}),$("button[type='reset']").on("click",function(){for(var e=document.getElementById("alertErr"),s=document.getElementById("alertSuc"),t=document.getElementsByClassName("has-error"),o=document.getElementsByClassName("has-success");t.length>0;)t[0].classList.remove("has-error");for(;o.length>0;)o[0].classList.remove("has-success");e.classList.add("hidden"),s.classList.add("hidden")});